"use strict";function _gyro_scene(){var e=this;e.scene=new THREE.Scene,e.gravity=new THREE.Vector3(0,-64,0);var r=new THREE.AxisHelper(32);e.init=function(){e.scene.add(r)},e.physics=function(){}}function _gyro_renderer(e){var r=e.gyroRenderer=this;r.renderer=new THREE.WebGLRenderer({antialias:!0,sortObjects:!1,preserveDrawingBuffer:!0,shadowMapEnabled:!0}),$("#canvas").append(r.renderer.domElement),r.dime=function(){window.innerWidth/window.innerHeight>16/9?r.renderer.setSize(window.innerHeight*(16/9),window.innerHeight):r.renderer.setSize(window.innerWidth,window.innerWidth*(9/16))},r.init=function(){r.renderer.shadowMap.enabled=!0,r.renderer.shadowMap.type=THREE.PCFSoftShadowMap,r.dime(),$(r.dime),$(window).resize(r.dime)},r.physics=function(){}}function _gyro_lights(e){var r=e.gyroLights=this;r.ambientLight=new THREE.AmbientLight(16777215,.2),e.scene.add(r.ambientLight),r.pointLight1=new THREE.PointLight(16777215,.4,1024),r.pointLight2=new THREE.PointLight(16777215,.4,1024),r.pointLight3=new THREE.PointLight(16777215,.4,1024),r.pointLight4=new THREE.PointLight(16777215,.4,1024),r.spotLight=new THREE.SpotLight(16777215,2,1024,Math.PI/4,.5),r.init=function(){r.pointLight1.position.set(512,384,0),e.scene.add(r.pointLight1),r.pointLight2.position.set(-512,-384,0),e.scene.add(r.pointLight2),r.pointLight3.position.set(0,384,512),e.scene.add(r.pointLight3),r.pointLight4.position.set(0,-384,-512),e.scene.add(r.pointLight4),r.spotLight.position.set(256,384,256),r.spotLight.target.position.set(0,0,0),r.spotLight.castShadow=!0,r.spotLight.shadow.mapSize.width=r.spotLight.shadow.mapSize.height=1024,e.scene.add(r.spotLight)},r.physics=function(){}}function _gyro_camera(e){var r=e.gyroCamera=this;r.radius=384,r.phi=Math.PI/3,r.theta=0,e.camera1=new THREE.PerspectiveCamera(45,16/9,1,8192),e.camera2=new THREE.PerspectiveCamera(45,16/9,1,8192);e.camera2=new THREE.OrthographicCamera(-960,960,540,-540,1,8192),e.camera=e.camera1,r.init=function(){$(document).on("keydown",function(e){switch(e.keyCode){case 187:r.radius-=32,r.radius<32&&(r.radius=32);break;case 189:r.radius+=32,r.radius>512&&(r.radius=512);break;case 38:r.phi-=Math.PI/180*5,r.phi<Math.PI*(5/180)&&(r.phi=Math.PI*(5/180));break;case 40:r.phi+=Math.PI/180*5,r.phi>Math.PI-Math.PI*(30/180)&&(r.phi=Math.PI-Math.PI*(30/180));break;case 37:r.theta-=Math.PI/180*5;break;case 39:r.theta+=Math.PI/180*5}})},r.physics=function(){var o=(new THREE.Vector3).setFromSpherical(new THREE.Spherical(r.radius,r.phi,r.theta));e.group.updateMatrixWorld();var t=(new THREE.Vector3).setFromMatrixPosition(e.group.matrixWorld).normalize().multiplyScalar(512);e.camera1.position.set(o.x,o.y,o.z),e.camera1.lookAt(new THREE.Vector3(e.group.position.x,e.group.position.y/2,e.group.position.z)),e.camera2.position.set(t.x,t.y,t.z),e.camera2.lookAt(new THREE.Vector3(e.group.position.x,e.group.position.y/2,e.group.position.z));var i=r.radius/512;e.camera2.left=960*-i,e.camera2.right=960*i,e.camera2.top=540*i,e.camera2.bottom=540*-i,e.camera2.updateProjectionMatrix()}}function _gyro_gyro(e){var r=e.gyroGyro=this;e.rotationalAcceleration=Math.PI/180*.005,e.rotationalVelocity=256*e.rotationalAcceleration,e.precessionVelocity=0,r.radiusHolder=8,r.heightTopHolder=48,r.heightBottomHolder=96,e.orbitRadius=96,e.numberOfSpheres=16,e.sphereRadius=16,e.spheres=[],e.angle=-$('#form input[name="snutation"]:checked').val()/180*Math.PI,e.angleMax=Math.atan(e.orbitRadius/r.heightBottomHolder),r.isAccelerating=!1,e.group=new THREE.Object3D,e.pivot=new THREE.Object3D,r.noiseTexture=function(e){for(var r=new Uint8Array(1048576),o=0;o<1048576;o+=4)r[o+0]=Math.round(255*(1-.2*Math.random())),r[o+1]=r[o],r[o+2]=r[o],r[o+3]=Math.round(Math.random());var t=new THREE.DataTexture(r,512,512,THREE.RGBAFormat);return t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,t.needsUpdate=!0,t}(),r.init=function(){(t=new THREE.Mesh(new THREE.CylinderGeometry(4,12,12228,8*e.numberOfSpheres),new THREE.MeshLambertMaterial({color:16777215}))).castShadow=!0,t.receiveShadow=!0,t.position.y=-6114,e.scene.add(t),(t=new THREE.Mesh(new THREE.TorusGeometry(e.orbitRadius,e.sphereRadius,16,8*e.numberOfSpheres),new THREE.MeshPhysicalMaterial({color:16777198,map:r.noiseTexture}))).rotation.x=Math.PI/2,t.castShadow=!0,t.receiveShadow=!0,r.meshOuterRing=t,e.group.add(t),(t=new THREE.Mesh(new THREE.CylinderGeometry(e.orbitRadius,e.orbitRadius,2,8*e.numberOfSpheres),new THREE.MeshPhysicalMaterial({color:16760371,map:r.noiseTexture}))).castShadow=!0,t.receiveShadow=!0,r.meshInnerPlane=t,e.group.add(t),(t=new THREE.Mesh(new THREE.CylinderGeometry(r.radiusHolder,r.radiusHolder,r.heightTopHolder,8*e.numberOfSpheres),new THREE.MeshPhysicalMaterial({color:16777215,map:r.noiseTexture}))).castShadow=!0,t.receiveShadow=!0,t.position.y=r.heightTopHolder/2,e.group.add(t),(t=new THREE.Mesh(new THREE.CylinderGeometry(r.radiusHolder,0,r.heightBottomHolder,8*e.numberOfSpheres),new THREE.MeshPhysicalMaterial({color:16777215,map:r.noiseTexture}))).castShadow=!0,t.receiveShadow=!0,t.position.y=-r.heightBottomHolder/2,e.group.add(t);for(var o=0;o<e.numberOfSpheres;o++){var t,i=e.orbitRadius,a=Math.PI/2,n=o/e.numberOfSpheres*(2*Math.PI),s=(new THREE.Vector3).setFromSpherical(new THREE.Spherical(i,a,n));(t=new THREE.Mesh(new THREE.SphereGeometry(.8*e.sphereRadius,16,16),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.25,depthWrite:!1,depthTest:!0}))).castShadow=!0,t.receiveShadow=!0,t.position.set(s.x,s.y,s.z),e.spheres.push(t),e.group.add(t)}e.group.position.y=r.heightBottomHolder,e.pivot.add(e.group),e.pivot.rotation.z=this.angle,e.scene.add(e.pivot),$('#form input[name="malpha"]').click(function(r){$(this).is(":checked")?e.isTranslucent=!0:e.isTranslucent=!1}),$('#form input[name="snutation"]').change(function(){$(this).val();e.angle=-$(this).val()/180*Math.PI}),$(document).on("keydown",function(o){switch(o.keyCode){case 49:case 50:case 51:case 52:case 53:case 54:e.angle=-(o.keyCode-49)*(Math.PI/180)*10,$('#form input[name="snutation"]').prop("checked",!1),$('#form input[name="snutation"][value="'+10*(o.keyCode-49)+'"]').prop("checked",!0);break;case 32:r.isAccelerating=!0}}),$(document).on("keyup",function(e){switch(e.keyCode){case 32:r.isAccelerating=!1}})},r.physics=function(){e.pause||(r.isAccelerating&&(e.rotationalVelocity+=e.rotationalAcceleration*e.frameRateScale),e.group.rotation.y+=e.rotationalVelocity*e.frameRateScale,e.pivot.rotation.y-=e.precessionVelocity*e.frameRateScale*2),e.isTranslucent?(r.meshOuterRing.material.color.set(16777215),r.meshOuterRing.material.map=null,r.meshOuterRing.material.needsUpdate=!0,r.meshOuterRing.material.transparent=!0,r.meshOuterRing.material.opacity=.25,r.meshOuterRing.material.depthWrite=!1,r.meshOuterRing.material.depthTest=!0,r.meshInnerPlane.visible=!1):(r.meshOuterRing.material.color.set(16777198),r.meshOuterRing.material.map=r.noiseTexture,r.meshOuterRing.material.needsUpdate=!0,r.meshOuterRing.material.transparent=!1,r.meshOuterRing.material.opacity=1,r.meshOuterRing.material.depthWrite=!0,r.meshOuterRing.material.depthTest=!0,r.meshInnerPlane.visible=!0),e.pivot.rotation.z=e.angle,e.single?$(e.spheres).each(function(e,r){0!==e&&(r.visible=!1)}):$(e.spheres).each(function(e,r){r.visible=!0})}}function _gyro_arrows(e){var r=e.gyroArrows=this;r.arrowHelperAccelerationGravity=[],r.arrowHelperAccelerationRotational=[],r.arrowHelperReferenceTorqueArm=[],r.arrowHelperReferenceTorqueAxis=null,r.arrowHelperTorque=[],r.arrowHelperTorqueVertical=[],r.arrowHelperTorqueHorizontal=[],r.arrowHelperVeclotyRotational=[],r.arrowHelperVelocityPrecession=[],e.pivot.updateMatrixWorld(),e.group.updateMatrixWorld();for(var o,t=0;t<e.numberOfSpheres;t++)r.arrowHelperAccelerationGravity.push(new THREE.ArrowHelper(e.gravity,new THREE.Vector3(0,0,0),e.gravity.length(),255)),r.arrowHelperAccelerationGravity[t].visible=$('#form input[name="fgravity"]').is(":checked"),r.arrowHelperAccelerationRotational.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,65280)),r.arrowHelperAccelerationRotational[t].visible=$('#form input[name="frotational"]').is(":checked"),r.arrowHelperTorque.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,16777215)),r.arrowHelperTorque[t].visible=$('#form input[name="ftorque"]').is(":checked"),r.arrowHelperTorqueVertical.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,16776960)),r.arrowHelperTorqueVertical[t].visible=$('#form input[name="ftorquevertical"]').is(":checked"),r.arrowHelperTorqueHorizontal.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,16776960)),r.arrowHelperTorqueHorizontal[t].visible=$('#form input[name="ftorquehorizontal"]').is(":checked"),(o=new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,512,512)),o.computeLineDistances(),r.arrowHelperReferenceTorqueArm.push(new THREE.Line(o,new THREE.LineDashedMaterial({color:6710886,linewidth:1,scale:1,dashSize:8,gapSize:4}))),r.arrowHelperReferenceTorqueArm[t].geometry.dynamic=!0,r.arrowHelperReferenceTorqueArm[t].visible=$('#form input[name="ftorquereference"]').is(":checked"),r.arrowHelperVeclotyRotational.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,65280)),r.arrowHelperVeclotyRotational[t].visible=$('#form input[name="mrotational"]').is(":checked"),r.arrowHelperVelocityPrecession.push(new THREE.ArrowHelper(new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,0),1,16711680)),r.arrowHelperVelocityPrecession[t].visible=$('#form input[name="mprecession"]').is(":checked");(o=new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,0)),o.vertices.push(new THREE.Vector3(0,1,0)),o.computeLineDistances(),r.arrowHelperReferenceTorqueAxis=new THREE.Line(o,new THREE.LineDashedMaterial({color:6710886,linewidth:1,scale:1,dashSize:8,gapSize:4})),r.arrowHelperReferenceTorqueAxis.geometry.dynamic=!0,r.arrowHelperReferenceTorqueAxis.visible=$('#form input[name="ftorquereference"]').is(":checked"),r.init=function(){for(var o=0;o<e.numberOfSpheres;o++)e.scene.add(r.arrowHelperAccelerationGravity[o]),e.scene.add(r.arrowHelperAccelerationRotational[o]),e.scene.add(r.arrowHelperTorque[o]),e.scene.add(r.arrowHelperTorqueVertical[o]),e.scene.add(r.arrowHelperTorqueHorizontal[o]),e.scene.add(r.arrowHelperReferenceTorqueArm[o]),e.scene.add(r.arrowHelperVeclotyRotational[o]),e.scene.add(r.arrowHelperVelocityPrecession[o]);e.scene.add(r.arrowHelperReferenceTorqueAxis),$('#form input[name="fgravity"]').click(function(e){$(this).is(":checked")?r.arrowHelperAccelerationGravity[0].visible=!0:r.arrowHelperAccelerationGravity[0].visible=!1}),$('#form input[name="frotational"]').click(function(e){$(this).is(":checked")?r.arrowHelperAccelerationRotational[0].visible=!0:r.arrowHelperAccelerationRotational[0].visible=!1}),$('#form input[name="ftorque"]').click(function(e){$(this).is(":checked")?r.arrowHelperTorque[0].visible=!0:r.arrowHelperTorque[0].visible=!1}),$('#form input[name="ftorquevertical"]').click(function(e){$(this).is(":checked")?r.arrowHelperTorqueVertical[0].visible=!0:r.arrowHelperTorqueVertical[0].visible=!1}),$('#form input[name="ftorquehorizontal"]').click(function(e){$(this).is(":checked")?r.arrowHelperTorqueHorizontal[0].visible=!0:r.arrowHelperTorqueHorizontal[0].visible=!1}),$('#form input[name="ftorquereference"]').click(function(e){$(this).is(":checked")?(r.arrowHelperReferenceTorqueArm[0].visible=!0,r.arrowHelperReferenceTorqueAxis.visible=!0):(r.arrowHelperReferenceTorqueArm[0].visible=!1,r.arrowHelperReferenceTorqueAxis.visible=!1)}),$('#form input[name="mrotational"]').click(function(e){$(this).is(":checked")?r.arrowHelperVeclotyRotational[0].visible=!0:r.arrowHelperVeclotyRotational[0].visible=!1}),$('#form input[name="mprecession"]').click(function(e){$(this).is(":checked")?r.arrowHelperVelocityPrecession[0].visible=!0:r.arrowHelperVelocityPrecession[0].visible=!1})},r.physics=function(){e.pivot.updateMatrixWorld(),e.group.updateMatrixWorld();var o=(new THREE.Vector3).setFromMatrixPosition(e.group.matrixWorld);e.precessionVelocity=2*(Math.log(Math.cos(0))-Math.log(Math.cos(e.angleMax)))*Math.sin(e.angle)/(1024*Math.pow(e.rotationalVelocity,2)*64);for(var t=0;t<e.numberOfSpheres;t++){e.spheres[t].updateMatrixWorld();var i=t/e.numberOfSpheres*(2*Math.PI)+e.group.rotation.y,a=(new THREE.Vector3).setFromMatrixPosition(e.spheres[t].matrixWorld),n=o.clone().sub(a).cross(a),s=e.gyroGyro.isAccelerating?550040*e.rotationalAcceleration:1e-8,c=(new THREE.Vector3).setFromSpherical(new THREE.Spherical(1,Math.PI/2,e.pivot.rotation.y)),l=(new THREE.Vector3).setFromSpherical(new THREE.Spherical(e.orbitRadius*Math.cos(i),Math.PI/2,e.pivot.rotation.y)),h=a.clone().sub(l).angleTo(o),p=a.distanceTo(l),u=c.clone().cross(a).multiplyScalar(Math.sin(e.angle)),m=1/p*1024*12*Math.sin(e.angle);Math.sin(i)<0&&(h=-h);var d=o.angleTo(u),g=-m*Math.cos(d),w=o.clone().normalize().multiplyScalar(g),H=o.clone().cross(c),y=Math.sqrt(Math.pow(m,2)-Math.pow(g,2)),f=1024*e.rotationalVelocity,E=(Math.log(Math.cos(h))-Math.log(Math.cos(e.angleMax)))*Math.sin(e.angle)/(4*Math.pow(e.rotationalVelocity,2));Math.cos(i)>0&&(E=-E);var v=o.clone().normalize().multiplyScalar(E);0==(m=Math.abs(m))&&(m=1e-8),0==f&&(f=1e-8),0==(g=Math.abs(g))&&(g=1e-8),0==(y=Math.abs(y))&&(y=1e-8),0==(E=Math.abs(E))&&(E=1e-8),r.arrowHelperAccelerationGravity[t].position.set(a.x,a.y,a.z),r.arrowHelperAccelerationGravity[t].setDirection(e.gravity.clone().normalize()),r.arrowHelperAccelerationGravity[t].setLength(e.gravity.length()),r.arrowHelperAccelerationRotational[t].position.set(a.x,a.y,a.z),r.arrowHelperAccelerationRotational[t].setDirection(n.clone().normalize()),r.arrowHelperAccelerationRotational[t].setLength(s),r.arrowHelperTorque[t].position.set(a.x,a.y,a.z),r.arrowHelperTorque[t].setDirection(u.clone().normalize()),r.arrowHelperTorque[t].setLength(m),r.arrowHelperTorqueVertical[t].position.set(a.x,a.y,a.z),r.arrowHelperTorqueVertical[t].setDirection(w.clone().normalize()),r.arrowHelperTorqueVertical[t].setLength(g),r.arrowHelperTorqueHorizontal[t].position.set(a.x,a.y,a.z),r.arrowHelperTorqueHorizontal[t].setDirection(H.clone().normalize()),r.arrowHelperTorqueHorizontal[t].setLength(y),r.arrowHelperReferenceTorqueArm[t].geometry.vertices[0].set(a.x,a.y,a.z),r.arrowHelperReferenceTorqueArm[t].geometry.vertices[1].set(l.x,l.y,l.z),r.arrowHelperReferenceTorqueArm[t].geometry.verticesNeedUpdate=!0,r.arrowHelperVeclotyRotational[t].position.set(a.x,a.y,a.z),r.arrowHelperVeclotyRotational[t].setDirection(n.clone().normalize()),r.arrowHelperVeclotyRotational[t].setLength(f),r.arrowHelperVelocityPrecession[t].position.set(a.x,a.y,a.z),r.arrowHelperVelocityPrecession[t].setLength(E),r.arrowHelperVelocityPrecession[t].setDirection(v.clone().normalize())}l=(new THREE.Vector3).setFromSpherical(new THREE.Spherical(e.orbitRadius,Math.PI/2,e.pivot.rotation.y));r.arrowHelperReferenceTorqueAxis.geometry.vertices[0].set(l.x,l.y,l.z),r.arrowHelperReferenceTorqueAxis.geometry.vertices[1].set(-l.x,-l.y,-l.z),r.arrowHelperReferenceTorqueAxis.geometry.verticesNeedUpdate=!0,$(r.arrowHelperAccelerationGravity).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperAccelerationGravity[0].visible}),$(r.arrowHelperAccelerationRotational).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperAccelerationRotational[0].visible}),$(r.arrowHelperReferenceTorqueArm).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperReferenceTorqueArm[0].visible}),$(r.arrowHelperTorque).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperTorque[0].visible}),$(r.arrowHelperTorqueVertical).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperTorqueVertical[0].visible}),$(r.arrowHelperTorqueHorizontal).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperTorqueHorizontal[0].visible}),$(r.arrowHelperVeclotyRotational).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperVeclotyRotational[0].visible}),$(r.arrowHelperVelocityPrecession).each(function(o,t){e.single&&0!==o?t.visible=!1:t.visible=r.arrowHelperVelocityPrecession[0].visible})}}!function(){function e(){r.physics(),r.gyroLights.physics(),r.gyroCamera.physics(),r.gyroGyro.physics(),r.gyroArrows.physics(),r.gyroRenderer.renderer.render(r.scene,r.camera),r.frameSkipCount++}var r=new _gyro_scene;r.pause=$('#form input[name="mpause"]').is(":checked"),r.frameRateScale=1/parseInt($('#form input[name="sspeed"]:checked').val()),r.single=$('#form input[name="msingle"]').is(":checked"),r.isTranslucent=$('#form input[name="malpha"]').is(":checked"),r.is_touch_device=function(){return"ontouchstart"in window||navigator.maxTouchPoints},new _gyro_renderer(r),new _gyro_lights(r),new _gyro_camera(r),new _gyro_gyro(r),new _gyro_arrows(r),$('#form input[name="mpause"]').prop("checked",r.pause),function(e,r){function o(e){null===a&&(a=e);var s=Math.floor((e-a)/i);s>n&&r({time:e,frame:n=s}),t=requestAnimationFrame(o)}var t,i=1e3/e,a=null,n=-1;t=requestAnimationFrame(o)}(60,e),function(){r.init(),r.gyroRenderer.init(),r.gyroLights.init(),r.gyroCamera.init(),r.gyroGyro.init(),r.gyroArrows.init(),$(document).on("keydown",function(e){switch(e.keyCode){case 80:r.pause=!r.pause,$('#form input[name="mpause"]').prop("checked",r.pause)}}),$("#form").on("keydown",function(e){e.stopPropagation()}),$('#form input[name="msingle"]').click(function(e){$(this).is(":checked")?r.single=!0:r.single=!1}),$('#form input[name="mpause"]').click(function(e){$(this).is(":checked")?r.pause=!0:r.pause=!1}),$('#form input[name="sspeed"]').change(function(e){r.frameRateScale=1/parseInt($(this).val())}),$("#form").click(function(e){$("#form, #form *").blur(),$("#canvas").focus(),$("#canvas").click()}),$("#form .button").click(function(e){$("#form").toggleClass("hidden")}),$("#form").on("mousedown",function(e){$("#form").css({opacity:.25})}),$("#form").on("mouseup",function(e){$("#form").css({opacity:1})}),$("#form").on("mouseleave",function(e){$("#form").css({opacity:1})}),$("#canvas").attr("tabindex","-1"),$("#canvas").focus(),$("#canvas").click(),$("canvas").on("mousedown",function(e){if(!r.is_touch_device()){e.preventDefault();var o=e.pageX,t=e.pageY,i=r.gyroCamera.phi,a=r.gyroCamera.theta;$(this).on("mousemove",function(e){if(!r.is_touch_device()){e.preventDefault();var n=o-e.pageX,s=t-e.pageY;r.gyroCamera.phi=i+s/256,r.gyroCamera.phi<Math.PI*(5/180)&&(r.gyroCamera.phi=Math.PI*(5/180)),r.gyroCamera.phi>Math.PI-Math.PI*(30/180)&&(r.gyroCamera.phi=Math.PI-Math.PI*(30/180)),r.gyroCamera.theta=a+n/256}})}}).on("mouseup mouseout",function(e){r.is_touch_device()||$(this).unbind("mousemove")});var e={ID1:-1,ID2:-1,touchX_start:0,touchY_start:0,zoom_start:0,radius_start:r.gyroCamera.radius,phi_start:r.gyroCamera.phi,theta_start:r.gyroCamera.theta};$("canvas").on("touchstart",function(o){r.is_touch_device()&&(o.preventDefault(),1==o.originalEvent.touches.length?(e.ID1=o.originalEvent.changedTouches[0].identifier,e.ID2=-1,e.touchX_start=o.originalEvent.changedTouches[0].pageX,e.touchY_start=o.originalEvent.changedTouches[0].pageY,e.radius_start=r.gyroCamera.radius,e.phi_start=r.gyroCamera.phi,e.theta_start=r.gyroCamera.theta,$(this).on("touchmove",function(o){if(r.is_touch_device()){var t=0;$(o.originalEvent.touches).each(function(r,i){i.identifier==e.ID1&&$(o.originalEvent.touches).each(function(r,o){o.identifier==e.ID2&&(t=Math.sqrt(Math.pow(i.pageX-o.pageX,2)+Math.pow(i.pageY-o.pageY,2)))})}),0!=t&&(t=e.zoom_start-t);var i=e.touchX_start,a=e.touchY_start;$(o.originalEvent.changedTouches).each(function(r,o){o.identifier==e.ID1&&(i-=o.pageX,a-=o.pageY)}),r.gyroCamera.radius=e.radius_start+t,r.gyroCamera.radius<32&&(r.gyroCamera.radius=32),r.gyroCamera.radius>512&&(r.gyroCamera.radius=512),r.gyroCamera.phi=e.phi_start+a/512,r.gyroCamera.phi<Math.PI*(5/180)&&(r.gyroCamera.phi=Math.PI*(5/180)),r.gyroCamera.phi>Math.PI-Math.PI*(30/180)&&(r.gyroCamera.phi=Math.PI-Math.PI*(30/180)),r.gyroCamera.theta=e.theta_start+i/256}})):(e.ID2=o.originalEvent.changedTouches[0].identifier,$(o.originalEvent.touches).each(function(r,t){t.identifier==e.ID1&&(e.zoom_start=Math.sqrt(Math.pow(t.pageX-o.originalEvent.changedTouches[0].pageX,2)+Math.pow(t.pageY-o.originalEvent.changedTouches[0].pageY,2)))})))}).on("touchend touchleave touchcancel",function(o){r.is_touch_device()&&(o.originalEvent.changedTouches[0].id==e.ID1?($(this).unbind("touchmove"),o.originalEvent.touches.length>0?(e.ID1=o.originalEvent.touches[0].identifier,e.touchX_start=o.originalEvent.touches[0].pageX,e.touchY_start=o.originalEvent.touches[0].pageY,e.phi_start=r.gyroCamera.phi,e.theta_start=r.gyroCamera.theta):e.ID1=-1):o.originalEvent.changedTouches[0].id==e.ID2&&(e.ID2=-1))}),$("canvas").on("scroll mousewheel",function(e){if(!r.is_touch_device())return e.preventDefault(),e.delta=null,e.originalEvent&&(e.originalEvent.wheelDelta&&(e.delta=e.originalEvent.wheelDelta/-40),e.originalEvent.deltaY&&(e.delta=e.originalEvent.deltaY),e.originalEvent.detail&&(e.delta=e.originalEvent.detail)),null!=e.delta&&(r.gyroCamera.radius+=e.delta,r.gyroCamera.radius<32&&(r.gyroCamera.radius=32),r.gyroCamera.radius>512&&(r.gyroCamera.radius=512)),!1})}(),e()}();
//# sourceMappingURL=gyro.min.js.map